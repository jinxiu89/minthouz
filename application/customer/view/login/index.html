{extend name="base/base_reg" /}
{block name="title"}
<title>{:lang('login')}</title>
{/block}
{block name="style"}
<link rel="stylesheet" href="__USER__/css/login.css">
{/block}
{block name="right"}
<div class="user_login_right">
    <div>
        <h1>
            <a href="https://www.wavlink.com"><img class="img-responsive center-block"
                                                   src="__USER__/img/icon/wavlink_logo.png"
                                                   alt="{:lang('Experience Center')}"></a>
        </h1>
    </div>
    <div>
        <form action="" id="login">
            <div>
                <label for="user_email"><i class="icon-user"></i></label>
                <input id="user_email" type="text" name="email" placeholder="{:lang('Input your E-mail')}">
            </div>
            <div>
                <label for="user_password"><i class="icon-key"></i></label>
                <input id="user_password" type="password" name="password" placeholder="{:lang('Input your password')}">
            </div>
            <button class="btn-success">{:lang('login')}</button>
        </form>
    </div>
    <div>
        <a href="/customer/register.html">{:lang('No account yet')}</a>
        <a href="/customer/forgotten.html">{:lang('Retrieve your password')}</a>
        <span></span>
        <span>{:lang('Or')}</span>
        <span></span>
    </div>
    <div>
        {if condition="$lang == 'zh_cn'"}
        <a href="#"><i class="icon-google-plus-sign"></i>微信</a>
        <a href="#"><i class="icon-facebook-sign"></i>QQ</a>
        {else /}
        <!--这里到时候根据语言ID来判断是用微信qq 还是谷歌 facebook-->
        <a href="#"><i class="icon-google-plus-sign"></i></a>
        <a href="#"><i class="icon-facebook-sign"></i></a>
        <a href="#"><i class="icon-linkedin-sign"></i></a>
        {/if}
    </div>
</div>
{/block}
{block name="js"}
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="__STATIC__/admin/lib/layer/2.4/layer.js"></script>
{if condition="$lang == 'zh_cn'"}
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/messages_zh.js"></script>
{/if}
<script>
    $("#login").validate({
        rules: {
            email: {
                required: true,
                email: true
            },
            password: {
                required: true,
                minlength: 8,
                maxlength: 16
            },
            repassword: {
                required: true,
                equalTo: "#user_password"
            }
        },
        errorElement: "em",
        onkeyup: false,
        focusCleanup: true,
        success: "valid",
        submitHandler: function (form) {
            $.ajax({
                url: '/customer/login',
                type: "post",
                dataType: "json",
                // data:postData,
                data: $("form").serialize(),//提交表单数据
                success: function (result) {
                    if (result.status === 1) {
                        //注册成功后要跳转到登录
                        layer.msg(result.message, {icon: 1, time: 3000});
                        setTimeout(function () {
                            window.parent.location.href=result.jump_url
                        },1000)
                    } else {
                        layer.msg(result.message, {icon: 5, time: 3000});
                    }
                }
            })
        }
    });
</script>
{/block}