{extend name="base/base" /}
{block name="title"}
<title>基本信息</title>
{/block}
{block name="style"}
<link rel="stylesheet" href="__USER__/css/information.css">
{/block}
{block name="path"}
<div class="path">
    <ul>
        <li><a href="https://www.wavlink.com">首页</a></li>
        <li> ></li>
        <li><a href="1-public.html">个人中心</a></li>
        <li> ></li>
        <li><a href="#">基本信息</a></li>
    </ul>
</div>
{/block}
{block name="navbar"}
{include file="base/navbar" /}
{/block}
{block name="main"}
<div class="main">
    <div class="main_title">
        <h2>基本信息</h2>
    </div>
    <div class="main_container">
        <ul>
            <li>修改基本信息</li>
            <li>修改密码</li>
            <li>修改邮箱</li>
        </ul>
        <div>
            <div class="basic_info">
                <form action="" id="baseInfo">
                    <div>
                        <label for="firstName">姓氏</label>
                        <input id="firstName" name="first_name" type="text" placeholder="please enter your frist name">
                    </div>
                    <div>
                        <label for="lastName">名字</label>
                        <input id="lastName" name="last_name" type="text" placeholder="please enter your last name">
                    </div>
                    <div>
                        <label for="selectSex">称谓</label>
                        <select name="title" id="selectSex">
                            <option value="保密">保密</option>
                            <option value="先生">先生</option>
                            <option value="女士">女士</option>
                        </select>
                    </div>
                    <div>
                        <label for="email">邮箱</label>
                        <input id="email" type="text" placeholder="11111111@qq.com" readonly="readonly">
                    </div>
                    <div>
                        <label for="password">密码</label>
                        <input id="password" type="text" placeholder="***********" readonly="readonly">
                    </div>
                    <div>
                        <label for="county">国家</label>
                        <select name="county_id" id="county">
                            <option value="常用" disabled="disabled">常用</option>
                            {volist name="country" id="vo"}
                            <option value="{$vo.country_id}">{:lang($vo.name)}</option>
                            {/volist}
                        </select>
                    </div>
                    <div>
                        <label for="phone">电话</label>
                        <select name="AreaCode" id="phones">
                            <option value="常用" disabled="disabled">常用</option>
                            <option value="中国">中国+86</option>
                        </select>
                        <input id="phone" name="tel" type="text" placeholder="please enter your phone number">
                    </div>
                    <div>
                        <label for="postalCode">邮编</label>
                        <input id="postalCode" name="zip_code" type="text" placeholder="please enter your postal code">
                    </div>
                    <div>
                        <label for="profession">职业</label>
                        <input id="profession" name="professional" type="text" placeholder="please enter your profession">
                    </div>
                    <div>
                        <label for="billingAddress">账单地址</label>
                        <input id="billingAddress" name="billing_address" type="text" placeholder="please enter your billing address">
                    </div>
                    <div>
                        <label for="mailingAddress">邮寄地址</label>
                        <input id="mailingAddress" name="delivery_address" type="text" placeholder="please enter your mailing address">
                    </div>
                    <div>
                        <label for="whereToKnow">您是通过哪种途径知道我们的网站</label>
                        <input id="whereToKnow" name="where_to" type="text" placeholder="How do you know our website">
                    </div>
                    <div>
                        <input type="hidden" name="id" value="result.id">
                        <button class="btn-group">保存</button>
                    </div>
                </form>
            </div>
            <div class="change_password">
                <form action="">
                    <div>
                        <label for="oldPassword">旧密码</label>
                        <input id="oldPassword" type="text" placeholder="Please enter the old password">
                    </div>
                    <div>
                        <label for="newPassword">新密码</label>
                        <input id="newPassword" type="text" placeholder="Please enter the new password">
                    </div>
                    <div>
                        <label for="newPasswordSure">确认新密码</label>
                        <input id="newPasswordSure" type="text" placeholder="Please confirm the new password">
                    </div>
                    <div>
                        <button class="btn-group">保存</button>
                    </div>
                </form>
            </div>
            <div class="change_email">
                <form action="">
                    <div>
                        <label for="changeEmail">邮箱</label>
                        <input id="changeEmail" type="text" placeholder="Please enter your new email">
                    </div>
                    <div>
                        <button class="btn-group">下一步</button>
                    </div>
                </form>
                <div>
                    <p>温馨提示：</p>
                    <p>1、修改绑定邮箱后，请您前往您的新邮箱进行验证；</p>
                    <p>2、完成邮箱验证后，您需要重新登录。</p>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}
{block name="js"}
<!--私有JS-->
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/jquery.validate.js"></script>
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/validate-methods.js"></script>
<script type="text/javascript" src="__STATIC__/admin/lib/layer/2.4/layer.js"></script>
{if condition="$lang == 'zh_cn'"}
<script type="text/javascript" src="__STATIC__/admin/lib/jquery.validation/1.14.0/messages_zh.js"></script>
{/if}
<script>
    $(document).ready(function () {
        var liNumbers = $('div.main_container>ul>li'),
            divNumbers = $('div.main_container>div>div'),
            divpassword = $('div.main_container>div>div.change_password'),
            divemail = $('div.main_container>div>div.change_email');
        for (var i = 0; i < liNumbers.length; i++) {
            (function (i) {
                liNumbers[i].onclick = function () {
                    liNumbers.eq(i).css('background', '#fff');
                    liNumbers.eq(i).siblings().css('background', '#f2f2f2');
                    divNumbers.eq(i).siblings().css('display', 'none');
                    divNumbers.eq(i).fadeIn();
                }
            })(i)
        }
        $('div.basic_info>form input#password').next('i').click(function () {
            divpassword.fadeIn();
            divpassword.siblings().css('display', 'none');
            liNumbers.eq(1).css('background', '#fff');
            liNumbers.eq(1).siblings().css('background', '#f2f2f2')
        });
        $('div.basic_info>form input#email').next('i').click(function () {
            divemail.fadeIn();
            divemail.siblings().css('display', 'none');
            liNumbers.eq(2).css('background', '#fff');
            liNumbers.eq(2).siblings().css('background', '#f2f2f2')
        });
    });
    $("#base_info").addClass("current");
    $("#baseInfo").validate({
        rules: {
            email: {
                required: true,
                email: true
            },
            password: {
                required: true,
                minlength: 8,
                maxlength: 16
            }
        },
        errorElement: "em",
        onkeyup: false,
        focusCleanup: true,
        success: "valid",
        submitHandler: function (form) {
            $.ajax({
                url: '/customer/info',
                type: "post",
                dataType: "json",
                // data:postData,
                data: $("form").serialize(),//提交表单数据
                success: function (result) {
                    if (result.status == 1) {
                        //注册成功后要跳转到登录
                        layer.msg(result.message, {icon: 1, time: 3000});
                        console.log(result);
                        window.parent.location.href=result.jump_url
                    } else {
                        layer.msg(result.message, {icon: 5, time: 3000});
                        window.parent.location.reload();
                    }
                }
            })
        }
    });
</script>
{/block}